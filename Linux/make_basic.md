**make命令的作用？**

在一个大型程序中，make 命令自动确定哪些部分需要被重新编译，并且执行相应命令来重新编译这些部分。

**如何确定？**

make 使用makefile文件中指定的命令以及文件的最近修改时间来决定哪些文件需要被更新。因此只要某个操作修改了文件的最近修改时间，就有可能被make重新编译，即使你并未实际修改文件的内容，常见的就是vim打开文件，不执行任何修改，在执行：wq命令，此时文件内容没有更新，但是文件的时间戳更新了，这会被make侦测到。

侦测到修改之后，make 会执行makefile文件中记录的命令。

如何没有`-f` 选项，make 会按顺序搜索GNUmakefile, makefile和Makefile这些名字的makefile文件

make 命令不止局限于自动确定大型程序的自动更新部分，你可以使用make来描述任何任务，这个任务里面的某个文件依赖于其他文件且当其他文件改变的时候需要自动更新前者。

**如何使用make命令？**

为了准备使用make命令，你必须写一个叫做makefile的文件，这个makefile文件描述了你程序中的文件们之间的关系，并且提供了命令来更新这些文件。通常来说，在一个程序中，可执行文件从目标文件中更新，而这些目标文件又是从源文件编译而来的。

一旦一个合适的makefile文件存在，每次当你更新程序中的某些源文件，这个简单的shell命令：

```shell
make
```

就足够执行所有必须的重新编译操作。

你可以提供命令行参数给make来控制哪些文件应该被重新编译或者如何。

makefile 文件是来告诉make命令如何做的。

### Arguments to Specify the Goals

The *goals* are the targets that `make` should strive ultimately to update. Other targets are updated as well if they appear as prerequisites of goals, or prerequisites of prerequisites of goals, etc.

By default, the goal is the first target in the makefile (not counting targets that start with a period). Therefore, makefiles are usually written so that the first target is for compiling the entire program or programs they describe. If the first rule in the makefile has several targets, only the first target in the rule becomes the default goal, not the whole list.

### What a Rule Looks Like

A simple makefile consists of “rules” with the following shape:

```shell
target … : prerequisites …
 recipe
 …
```

A *target* is usually the name of a file that is generated by a program; examples of targets are executable or object files. A target can also be the name of an action to carry out, such as ‘clean’ (see [Phony Targets](https://www.gnu.org/software/make/manual/make.html#Phony-Targets)).

A *prerequisite* is a file that is used as input to create the target. A target often depends on several files.

A *recipe* is an action that `make` carries out. A recipe may have more than one command, either on the same line or each on its own line. **Please note:** you need to put a tab character at the beginning of every recipe line! This is an obscurity that catches the unwary. If you prefer to prefix your recipes with a character other than tab, you can set the `.RECIPEPREFIX` variable to an alternate character (see [Other Special Variables](https://www.gnu.org/software/make/manual/make.html#Special-Variables)).

当目标的前提条件变化了的时候，目标就需要重新产生，并且会递归。

When a target is a file, it needs to be recompiled or relinked if any
of its prerequisites change.  In addition, any prerequisites that are
themselves automatically generated should be updated first.  
